import{parse as t,stringify as r}from"qs";function e(){return e=Object.assign?Object.assign.bind():function(t){for(var r=1;r<arguments.length;r++){var e=arguments[r];for(var i in e)({}).hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},e.apply(null,arguments)}class i{constructor(t,r,e){var i,s;this.name=void 0,this.definition=void 0,this.config=void 0,this.bindings=void 0,this.wheres=void 0,this.name=t,this.definition=r,this.bindings=null!=(i=r.bindings)?i:{},this.wheres=null!=(s=r.wheres)?s:{},this.config=e}get template(){var t;const r=`${this.origin}/${null==(t=this.definition)?void 0:t.uri}`.replace(/\/+$/,"");return""===r?"/":r}get origin(){var t,r,e;return this.config.absolute?null!=(t=this.definition)&&t.domain?`${null==(r=this.config.url.match(/^\w+:\/\//))?void 0:r[0]}${null==(e=this.definition)?void 0:e.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var t,r;return null!=(t=null==(r=this.template.match(/{[^}?]+\??}/g))?void 0:r.map(t=>({name:t.replace(/{|\??}/g,""),required:!/\?}$/.test(t)})))?t:[]}matchesUrl(r){var e,i;if(null==(e=this.definition)||!e.methods.includes("GET"))return!1;const s=this.template.replace(/[.*+$()[\]]/g,"\\$&").replace(/(\/?){([^}?]*)(\??)}/g,(t,r,e,i)=>{var s;const n=`(?<${e}>${(null==(s=this.wheres[e])?void 0:s.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return i?`(${r}${n})?`:`${r}${n}`}).replace(/^\w+:\/\//,""),[n,o]=r.replace(/^\w+:\/\//,"").split("?"),u=null!=(i=new RegExp(`^${s}/?$`).exec(n))?i:new RegExp(`^${s}/?$`).exec(decodeURI(n));if(u){for(const t in u.groups)u.groups[t]="string"==typeof u.groups[t]?decodeURIComponent(u.groups[t]):u.groups[t];return{params:u.groups,query:t(o)}}return!1}compile(t){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(r,e,i)=>{var s,n;if(!i&&[null,void 0].includes(t[e]))throw new Error(`useRouter() Rzl-Zg Error: '${e}' parameter is required for route '${this.name}'.`);if(this.wheres[e]&&!new RegExp(`^${i?`(${this.wheres[e]})?`:this.wheres[e]}$`).test(null!=(n=t[e])?n:""))throw new Error(`useRouter() Rzl-Zg Error: '${e}' parameter '${t[e]}' does not match required format '${this.wheres[e]}' for route '${this.name}'.`);return encodeURI(null!=(s=t[e])?s:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class s extends String{constructor(t,r,s=!0,n){if(super(),this.t=void 0,this.i=void 0,this.o=void 0,this.t=null!=n?n:"undefined"!=typeof appRoutes?appRoutes:null==globalThis?void 0:globalThis.appRoutes,this.t=e({},this.t,{absolute:s}),t){if(!this.t.routes[t])throw new Error(`useRouter() Rzl-Zg Error: route '${t}' is not in the route list.`);this.i=new i(t,this.t.routes[t],this.t),this.o=this.u(r)}}toString(){const t=Object.keys(this.o).filter(t=>!this.i.parameterSegments.some(({name:r})=>r===t)).filter(t=>"_query"!==t).reduce((t,r)=>e({},t,{[r]:this.o[r]}),{});return this.i.compile(this.o)+r(e({},t,this.o._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(t,r)=>"boolean"==typeof t?Number(t):r(t)})}h(t){t?this.t.absolute&&t.startsWith("/")&&(t=this.l().host+t):t=this.p();let r={};const[s,n]=Object.entries(this.t.routes).find(([e,s])=>r=new i(e,s,this.t).matchesUrl(t))||[void 0,void 0];return e({name:s},r,{route:n})}p(){const{host:t,pathname:r,search:e}=this.l();return(this.t.absolute?t+r:r.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+e}current(t,r){const{name:s,params:n,query:o,route:u}=this.h();if(!t)return s;const h=new RegExp(`^${t.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(s);if([null,void 0].includes(r)||!h)return h;const l=new i(s,u,this.t);r=this.u(r,l);const a=e({},n,o);if(Object.values(r).every(t=>!t)&&!Object.values(a).some(t=>void 0!==t))return!0;const c=(t,r)=>Object.entries(t).every(([t,e])=>Array.isArray(e)&&Array.isArray(r[t])?e.every(e=>r[t].includes(e)):"object"==typeof e&&"object"==typeof r[t]&&null!==e&&null!==r[t]?c(e,r[t]):r[t]==e);return c(r,a)}l(){var t,r,e,i,s,n;const{host:o="",pathname:u="",search:h=""}="undefined"!=typeof window?window.location:{};return{host:null!=(t=null==(r=this.t.location)?void 0:r.host)?t:o,pathname:null!=(e=null==(i=this.t.location)?void 0:i.pathname)?e:u,search:null!=(s=null==(n=this.t.location)?void 0:n.search)?s:h}}get params(){const{params:t,query:r}=this.h();return e({},t,r)}get routeParams(){return this.h().params}get queryParams(){return this.h().query}has(t){return this.t.routes.hasOwnProperty(t)}u(t={},r=this.i){null!=t||(t={}),t=["string","number"].includes(typeof t)?[t]:t;const i=r.parameterSegments.filter(({name:t})=>!this.t.defaults[t]);return Array.isArray(t)?t=t.reduce((t,r,s)=>e({},t,i[s]?{[i[s].name]:r}:"object"==typeof r?r:{[r]:""}),{}):1===i.length&&(!t)[i[0].name]&&(t.hasOwnProperty(Object.values(r.bindings)[0])||t.hasOwnProperty("id"))&&(t={[i[0].name]:t}),e({},this.g(r),this.$(t,r))}g(t){return t.parameterSegments.filter(({name:t})=>this.t.defaults[t]).reduce((t,{name:r})=>e({},t,{[r]:this.t.defaults[r]}),{})}$(t,r){return Object.entries(t).reduce((t,[i,s])=>{if(!s||"object"!=typeof s||Array.isArray(s)||!r.parameterSegments.some(({name:t})=>t===i))return e({},t,{[i]:s});if(!s.hasOwnProperty(r.bindings[i])){if(!s.hasOwnProperty("id"))throw new Error(`useRouter() Rzl-Zg Error: object passed as '${i}' parameter is missing route model binding key '${r.bindings[i]}'.`);r.bindings[i]="id"}return e({},t,{[i]:s[r.bindings[i]]})},{})}valueOf(){return this.toString()}}function n(t,r,e=!1,i){const n=new s(t,r,e,i);return t?n.toString():n}const o={install:function(t,r){const e=(t,e,i,s=r)=>n(t,e,i,s);parseInt(t.version)>2?(t.config.globalProperties.route=e,t.provide("route",e)):t.mixin({methods:{route:e}})}};function u(t){if(!t&&!globalThis.appRoutes&&"undefined"==typeof appRoutes)throw new Error("useRouter() Rzl-Zg Error: missing configuration. Ensure that a `appRoutes` variable is defined globally or pass a config object into the useRoute hook.");return(r,e,i,s=t)=>n(r,e,i,s)}export{o as ZiggyVue,n as route,u as useRoute};
