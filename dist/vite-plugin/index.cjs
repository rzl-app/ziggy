"use strict";var p=require("path"),d=require("vite-plugin-run"),y=require("fs");function g(r){return r&&r.__esModule?r:{default:r}}var h=g(p),v={sail:!1,types:!0,typesOnly:!1,delay:100,throttle:300,only:[],except:[]},s="rzl-app/ziggy",f=()=>{try{let r=p.resolve(process.cwd(),"composer.json"),e=JSON.parse(y.readFileSync(r,"utf-8"));if(!e.require?.[s])throw new Error(`${s} not found in composer.json dependencies`);let n=e.require[s],t=n.match(/^[~^><]?(\d+)/);if(!t)throw new Error(`Invalid version format for ${s}: ${n}`);return t[1]}catch(r){throw r instanceof Error&&r.code==="ENOENT"?new Error("composer.json not found in project root"):r}},E=(r,e)=>{let n=[e.sail&&!process.env.LARAVEL_SAIL?"sail":"php","artisan","rzl-ziggy:generate"];return e.group&&n.push("--group",e.group),e.url&&n.push("--url",e.url),["1","2"].includes(r)&&(e.types&&n.push("--types"),e.typesOnly&&n.push("--types-only"),r==="1"&&(e.only.length>0&&n.push("--only",e.only.join(",")),e.except.length>0&&n.push("--except",e.except.join(",")))),n},m=(r={})=>{try{let e=f(),{delay:n,throttle:t,...u}=r,i=E(e,{...v,...u}),{configResolved:a,handleHotUpdate:c}=d.run(process.env.NODE_ENV==="development"?[{delay:n,throttle:t,name:"rzl-ziggy-generator",run:i,pattern:["routes/**/*.php",".*.env",".*.*.env",".env.*",".env.*.*"],condition:o=>{let l=h.default.relative(process.cwd(),o);return o.includes("/routes/")&&o.endsWith(".php")||o.includes("/")&&o.includes(".env")||/^routes\/.*\.php$/.test(l.replace(/\\/g,"/"))||/\.env(\..+)?$/.test(l)}}]:[]);return{name:"rzl-ziggy-plugin",configResolved:a,handleHotUpdate:c}}catch(e){if(console.error("[rzl-vite-plugin-ziggy] Error: "),e instanceof Error)console.error(e.message),process.env.NODE_ENV==="development"&&console.error(e.stack);else throw e}return{}};module.exports=m;
